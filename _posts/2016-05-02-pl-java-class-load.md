--- 
layout: post 
title: "Java: Class Loader" 
keywords: [] 
description: 
category: "PL"
tags: ["java"] 
--- 
{% include JB/setup %}
* content
{:toc}


### intro
在C++语言中，没有类加载器的概念，那么这个类加载器相当于什么呢？
<hr />
### 类加载过程
类加载机制是加载类的，它所处理的东西只和类相关。
<hr />
#### 源文件
java编译器把java代码编译为存储字节码的class文件，其他语言的编译器也可以把程序代码翻译成class文件，java虚拟机并不关心class的来源。
<hr />
#### 加载
加载阶段是最重要的阶段，也是开发期可控性最强的阶段，因为我们可以使用系统提供的类加载器，也可以自定义类加载器完成。
1. 使用类全名获取定义此类的二进制字节流
2. 将字节流所代表的静态存储结构转换为方法区的运行时数据结构
3. 在java堆中生成一个代表这个类的java.lang.Class对象;<font color="red">这个很有意思，字节码文件的后缀名为.class,生成的对象为Class对象</font>
<hr />
#### 链接
验证，准备和解析三个阶段统称为链接
<hr />
##### 验证
1. 文件格式验证
2. 元数据验证
3. 字节码验证
4. 符号引用验证
<hr />
##### 准备
准备阶段正式为类变量分配内存并设置类变量初始值的阶段，这些内存都在方法区进行分配
<hr />
##### 解析
解析阶段是虚拟机常量池内的符号引用直接替换为直接引用的过程。
+ 符号引用: 用一组符号来描述所引用的目标对象，符号引用可以是任何形式的字面量，只要在使用时能无歧义地定位到目标即可。符号引用与虚拟机的内存布局无关，引用的目标对象不一定加载到内存中
+ 直接引用: 直接引用可以是直接指向目标对象的指针，相对偏移量或是一个能间接定位到目标的句柄。直接引用与虚拟机的内存布局相关。
<hr />
#### 初始化
<hr />
#### 使用
<hr />
#### 卸载
<hr />
### 类加载器
JVM的designer把类加载阶段中的类加载阶段放到Java虚拟机的外部去实现，以便让应用程序自己决定如何去获取所需要的类。实现这个动作的代码块称为类加载器。
<hr />
#### 类与类加载器
对于任何一个类，都需要由加载它的类加载器和这个类来确立其在JVM中的唯一性。两个类来源于同一个class文件，并且被同一个加载器加载，这两个类才相等。
<hr />
#### 类加载器
<hr />
##### 启动类加载器
Bootstrap ClassLoader: 负责加载JAVA_HOME\lib目录中能被虚拟机识别的类库加载到JVM内存中。该类加载器无法被Java程序直接使用
<hr />
##### 扩展类加载器
Extension ClassLoader
<hr />
##### 应用程序类加载器
Application ClassLoader: 该类加载器为系统类加载器
<hr />
#### 类加载器工作原理

